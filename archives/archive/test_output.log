  console.info
    âœ… .env.test loaded.

      at loadEnvFile (node_modules/@colyseus/tools/build/loadenv.js:46:15)

  console.log
    --- beforeAll: Starting test setup ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:14:13)

  console.log
    --- beforeAll: Colyseus test server boot completed successfully ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:16:13)

  console.log
    --- beforeAll: Colyseus test server booted ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:17:13)

  console.log
    --- beforeEach: Creating room ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:21:13)

  console.log
    GameRoom created: {}

      at GameRoom.onCreate (src/server/game/GameRoom.ts:13:13)

  console.log
    --- beforeEach: Room created ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:23:13)

  console.log
    --- afterEach: Starting test teardown ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:27:13)

  console.log
    GameRoom disposed.

      at GameRoom.onDispose (src/server/game/GameRoom.ts:95:13)

  console.log
    --- afterEach: Room disconnected ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:30:15)

  console.log
    --- afterEach: Colyseus server shut down ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:35:17)

  console.log
    --- afterEach: Test teardown complete ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:40:13)

  console.log
    --- beforeEach: Creating room ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:21:13)

  console.log
    GameRoom created: {}

      at GameRoom.onCreate (src/server/game/GameRoom.ts:13:13)

  console.log
    --- beforeEach: Room created ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:23:13)

  console.log
    --- afterEach: Starting test teardown ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:27:13)

  console.log
    GameRoom disposed.

      at GameRoom.onDispose (src/server/game/GameRoom.ts:95:13)

  console.log
    --- afterEach: Room disconnected ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:30:15)

  console.log
    --- afterEach: Colyseus server shut down ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:35:17)

  console.log
    --- afterEach: Test teardown complete ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:40:13)

  console.log
    --- beforeEach: Creating room ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:21:13)

  console.log
    GameRoom created: {}

      at GameRoom.onCreate (src/server/game/GameRoom.ts:13:13)

  console.log
    --- beforeEach: Room created ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:23:13)

  console.log
    --- afterEach: Starting test teardown ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:27:13)

  console.log
    GameRoom disposed.

      at GameRoom.onDispose (src/server/game/GameRoom.ts:95:13)

  console.log
    --- afterEach: Room disconnected ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:30:15)

  console.log
    --- afterEach: Colyseus server shut down ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:35:17)

  console.log
    --- afterEach: Test teardown complete ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:40:13)

  console.log
    --- beforeEach: Creating room ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:21:13)

  console.log
    GameRoom created: {}

      at GameRoom.onCreate (src/server/game/GameRoom.ts:13:13)

  console.log
    --- beforeEach: Room created ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:23:13)

  console.log
    --- afterEach: Starting test teardown ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:27:13)

  console.log
    GameRoom disposed.

      at GameRoom.onDispose (src/server/game/GameRoom.ts:95:13)

  console.log
    --- afterEach: Room disconnected ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:30:15)

  console.log
    --- afterEach: Colyseus server shut down ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:35:17)

  console.log
    --- afterEach: Test teardown complete ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:40:13)

  console.log
    --- beforeEach: Creating room ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:21:13)

  console.log
    GameRoom created: {}

      at GameRoom.onCreate (src/server/game/GameRoom.ts:13:13)

  console.log
    --- beforeEach: Room created ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:23:13)

  console.log
    --- afterEach: Starting test teardown ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:27:13)

  console.log
    GameRoom disposed.

      at GameRoom.onDispose (src/server/game/GameRoom.ts:95:13)

  console.log
    --- afterEach: Room disconnected ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:30:15)

  console.log
    --- afterEach: Colyseus server shut down ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:35:17)

  console.log
    --- afterEach: Test teardown complete ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:40:13)

  console.log
    --- beforeEach: Creating room ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:21:13)

  console.log
    GameRoom created: {}

      at GameRoom.onCreate (src/server/game/GameRoom.ts:13:13)

  console.log
    --- beforeEach: Room created ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:23:13)

  console.log
    --- afterEach: Starting test teardown ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:27:13)

  console.log
    GameRoom disposed.

      at GameRoom.onDispose (src/server/game/GameRoom.ts:95:13)

  console.log
    --- afterEach: Room disconnected ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:30:15)

  console.log
    --- afterEach: Colyseus server shut down ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:35:17)

  console.log
    --- afterEach: Test teardown complete ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:40:13)

  console.log
    --- beforeEach: Creating room ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:21:13)

  console.log
    GameRoom created: {}

      at GameRoom.onCreate (src/server/game/GameRoom.ts:13:13)

  console.log
    --- beforeEach: Room created ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:23:13)

  console.log
    --- afterEach: Starting test teardown ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:27:13)

  console.log
    GameRoom disposed.

      at GameRoom.onDispose (src/server/game/GameRoom.ts:95:13)

  console.log
    --- afterEach: Room disconnected ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:30:15)

  console.log
    --- afterEach: Colyseus server shut down ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:35:17)

  console.log
    --- afterEach: Test teardown complete ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:40:13)

  console.log
    --- beforeEach: Creating room ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:21:13)

  console.log
    GameRoom created: {}

      at GameRoom.onCreate (src/server/game/GameRoom.ts:13:13)

  console.log
    --- beforeEach: Room created ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:23:13)

  console.log
    --- afterEach: Starting test teardown ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:27:13)

  console.log
    GameRoom disposed.

      at GameRoom.onDispose (src/server/game/GameRoom.ts:95:13)

  console.log
    --- afterEach: Room disconnected ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:30:15)

  console.log
    --- afterEach: Colyseus server shut down ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:35:17)

  console.log
    --- afterEach: Test teardown complete ---

      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:40:13)

FAIL src/server/__tests__/game/GameRoom.test.ts
  GameRoom
    âˆš should create a game room (15 ms)
    Player Management
      Ã— should allow a player to join (82 ms)
      Ã— should handle player movement (20 ms)
    Player Disconnection
      Ã— should remove player on leave (9 ms)
      Ã— should handle player reconnection (14 ms)
    Item Management
      Ã— should add starter items to a new player (9 ms)
      Ã— should drop player inventory as loot drops on leave (10 ms)
      Ã— should create a loot drop with correct properties (12 ms)

  â— GameRoom â€º Player Management â€º should allow a player to join

    ServerError: connect ECONNREFUSED 127.0.0.1:2568

      at node_modules/colyseus.js/src/HTTP.ts:42:19

  â— GameRoom â€º Player Management â€º should handle player movement

    ServerError: connect ECONNREFUSED 127.0.0.1:2568

      at node_modules/colyseus.js/src/HTTP.ts:42:19

  â— GameRoom â€º Player Disconnection â€º should remove player on leave

    ServerError: connect ECONNREFUSED 127.0.0.1:2568

      at node_modules/colyseus.js/src/HTTP.ts:42:19

  â— GameRoom â€º Player Disconnection â€º should handle player reconnection

    ServerError: connect ECONNREFUSED 127.0.0.1:2568

      at node_modules/colyseus.js/src/HTTP.ts:42:19

  â— GameRoom â€º Item Management â€º should add starter items to a new player

    ServerError: connect ECONNREFUSED 127.0.0.1:2568

      at node_modules/colyseus.js/src/HTTP.ts:42:19

  â— GameRoom â€º Item Management â€º should drop player inventory as loot drops on leave

    ServerError: connect ECONNREFUSED 127.0.0.1:2568

      at node_modules/colyseus.js/src/HTTP.ts:42:19

  â— GameRoom â€º Item Management â€º should create a loot drop with correct properties

    ServerError: connect ECONNREFUSED 127.0.0.1:2568

      at node_modules/colyseus.js/src/HTTP.ts:42:19

Test Suites: 1 failed, 1 total
Tests:       7 failed, 1 passed, 8 total
Snapshots:   0 total
Time:        1.086 s
Ran all test suites matching /src\\server\\__tests__\\game\\GameRoom.test.ts/i.

Jest has detected the following 1 open handle potentially keeping Jest from exiting:

  â—  Timeout

    [0m [90m 27 |[39m     console[33m.[39mlog([32m'--- afterEach: Starting test teardown ---'[39m)[33m;[39m
     [90m 28 |[39m     [36mif[39m (room) {
    [31m[1m>[22m[39m[90m 29 |[39m       [36mawait[39m room[33m.[39mdisconnect()[33m;[39m
     [90m    |[39m                  [31m[1m^[22m[39m
     [90m 30 |[39m       console[33m.[39mlog([32m'--- afterEach: Room disconnected ---'[39m)[33m;[39m
     [90m 31 |[39m     }
     [90m 32 |[39m     [36mtry[39m {[0m

      at Object.persist (node_modules/@colyseus/core/build/Stats.js:76:22)
      at disposeRoom (node_modules/@colyseus/core/build/MatchMaker.js:598:11)
      at GameRoom.disconnect (node_modules/@colyseus/core/build/Room.js:493:20)
      at Object.<anonymous> (src/server/__tests__/game/GameRoom.test.ts:29:18)

